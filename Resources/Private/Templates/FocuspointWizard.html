<html xmlns:f="http://typo3.org/ns/TYPO3/CMS/Fluid/ViewHelpers"
    xmlns:core="http://typo3.org/ns/TYPO3/CMS/Core/ViewHelpers">

    <f:section name="Main">

        <div class="modal-panel-main">
            <div id="t3js-crop-image-container" class="cropper-image-container">
                <div id="focuspoint-container">
                    <f:image image="{image}" maxWidth="1280" maxHeight="1280" id="t3js-crop-image" class="cropper-image-container-image" additionalAttributes="{data-original-width: image.properties.width, data-original-height: image.properties.height}" />
                    <f:for each="{focusPointsCount}" as="singlepoint" iteration="i">
                        <div data-focuspointBoxId="{i.index}" class="focuspoint-item focuspoint-item-hidden ui-draggable {f:if(condition:'{focusPoints.singlePoint.resizable}==1', then:'ui-resizable')} {f:if(condition:i.isLast, then:'focuspoint-item-dummy')}" style="width: {focusPoints.singlePoint.defaultWidth}; height: {focusPoints.singlePoint.defaultHeight};"><span>{i.cycle}</span></div>
                    </f:for>
                </div>
            </div>
        </div>
        <div class="modal-panel-sidebar">
            <div class="panel-group" id="accordion-cropper-variants" role="tablist" aria-multiselectable="true">
                <f:for each="{focusPointsCount}" as="singlepoint" iteration="i">
                    <div class="panel panel-default panel-hidden {f:if(condition:i.isLast, then:'panel-dummy')}">
                        <div class="panel-heading" role="tab" id="cropper-accordion-heading-{i.cycle}">
                            <h4 class="panel-title">
                                <a role="button" data-toggle="collapse" data-parent="#accordion-cropper-variants"
                                        href="#cropper-collapse-{i.cycle}"
                                        aria-expanded="{f:if(condition:i.isFirst, then:'true', else:'false')}"
                                        aria-controls="cropper-collapse-{i.cycle}"
                                        class="t3js-crop-variant-trigger {f:if(condition:i.isFirst, then:'is-active', else:'collapsed')}"
                                        data-crop-variant-id="###id###"
                                        data-crop-variant>
                                <span><i class="fa fa-chevron-down"
                                                    aria-hidden="true"></i> {f:translate(id:'{focusPoints.singlePoint.title}')} {i.cycle}</span>
                                </a>
                            </h4>
                        </div>
                        <div id="cropper-collapse-{i.cycle}"
                                    class="panel-collapse collapse {f:if(condition:i.isFirst, then:'in')}"
                                    role="tabpanel"
                                    aria-labelledby="cropper-accordion-heading-{i.cycle}">
                            <div class="panel-body">
                                <form>
                                    <input type="hidden" name="x" data-focuspointPanelId="{i.index}" />
                                    <input type="hidden" name="y" data-focuspointPanelId="{i.index}" />
                                    <input type="hidden" name="height" data-focuspointPanelId="{i.index}" />
                                    <input type="hidden" name="width" data-focuspointPanelId="{i.index}" />
                                    <f:for each="{focusPoints.singlePoint.fields}" as="field" key="fieldname" iteration="j">
                                        <f:render partial="FocuspointWizardInput" arguments="{field: field, fieldname: fieldname, i: i, j: j}" />
                                    </f:for>
                                    <div class="input-group pull-right">
                                        <button class="btn btn-danger singlepoint-delete"><i class="fa fa-trash"></i> <f:translate key="LLL:EXT:bw_focuspoint_images/Resources/Private/Language/locallang_db.xlf:wizard.single_point.button.delete"/></button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </f:for>
            </div>
            <div class="panel-body">
                <button data-method="new" class="btn btn-success btn-block"><i class="fa fa-plus"></i> <f:translate key="LLL:EXT:bw_focuspoint_images/Resources/Private/Language/locallang_db.xlf:wizard.single_point.button.addnew"/></button>
            </div>
        </div>

        <style type="text/css">
            .modal-body-focuspoints{
                display: flex;
                flex-wrap: wrap;
                padding: 0;
            }
            .modal-body-focuspoints .modal-panel-main{
                flex-grow: 1;
                padding: 15px;
                max-width: calc(100vw - 372px);
            }
            .modal-body-focuspoints .modal-panel-main .cropper-image-container{
                display: flex;
                justify-content: center;
                align-items: center;
                max-width: none !important;
            }
            .modal-body-focuspoints .modal-panel-main .cropper-image-container img{
                max-width: 100%;
                max-height: 100%;
                width: auto;
                height: auto;
            }
            .modal-body-focuspoints .modal-panel-main .cropper-image-container #focuspoint-container{
                position: relative;
            }
            .modal-body-focuspoints .modal-panel-main .cropper-image-container .focuspoint-item{
                position: absolute;
                background-color: rgba(0,0,0,0.6);
                color: #FFF;

                line-height: 7.6px;
                top: 0;
                left: 0;
                cursor: move;
            }
            .modal-body-focuspoints .modal-panel-main .cropper-image-container .focuspoint-item.focuspoint-item-dummy,
            .modal-body-focuspoints .modal-panel-main .cropper-image-container .focuspoint-item.focuspoint-item-hidden{
                display: none;
            }
            .modal-body-focuspoints .modal-panel-main .cropper-image-container .focuspoint-item span{
                border: 1px dotted rgba(255,255,255,0.6);
                padding: 5px;
                display: flex;
                width: 100%;
                height: 100%;
                justify-content: center;
                align-items: center;
            }



            .modal-body-focuspoints .modal-panel-sidebar{
                background-color: #333;
            }
            .modal-body-focuspoints .modal-panel-sidebar .panel-group{
                margin: 0;
                min-width: 332px;
            }
            .modal-body-focuspoints .modal-panel-sidebar .panel-hidden,
            .modal-body-focuspoints .modal-panel-sidebar .panel-dummy{
                display: none;
            }
            .modal-body-focuspoints .modal-panel-sidebar a[aria-expanded="true"] .fa-chevron-down{
                transform: rotate(180deg);
            }
            .modal-body-focuspoints .modal-panel-sidebar input, .modal-body-focuspoints .modal-panel-sidebar textarea, .modal-body-focuspoints .modal-panel-sidebar select{
                color: #333;
                width: 300px;
            }
            .modal-body-focuspoints .modal-panel-sidebar label:not(.element1), .modal-body-focuspoints .modal-panel-sidebar .singlepoint-delete{
                margin-top: 15px;
            }
        </style>

    </f:section>
</html>
